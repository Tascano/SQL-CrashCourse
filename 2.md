ðŸ§© Section 2 â€” Building the Base Dataset ðŸ—ï¸
This section introduces the User Engagement Platform schema, defines the relationships, and provides the necessary DDL (CREATE TABLE) statements and sample DML (INSERT) data.

2.1 The User Engagement Platform Schema
Our platform has four core entities that help us analyze user behavior on a content-based service (like Scribd or Netflix).

Schema Diagram (Conceptual ERD)

| Table | Purpose | Primary Key (PK) | Foreign Keys (FK) |
|-------|---------|-----------------|------------------|
| users | Stores basic profile information. | user_id | N/A |
| content | Stores metadata about the books, articles, or videos available. | content_id | N/A |
| subscriptions | Tracks a user's plan history and status. | (user_id, start_date) (Composite) | user_id (References users) |
| engagement | Records every interaction (read, view, click, etc.). This will be our largest table. | (user_id, content_id, event_time) (Composite) | user_id (References users), content_id (References content) |


2.2 DDL: Creating the Tables
Here are the CREATE TABLE statements, including the necessary constraints (Primary Keys, Foreign Keys, NOT NULL, and CHECK for data integrity).

```
-- 1. USERS TABLE
CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,              -- PK: Unique ID for each user. SERIAL implies auto-incrementing.
    name VARCHAR(100) NOT NULL,              -- Basic name. Cannot be null.
    country CHAR(3) NOT NULL,                -- 3-letter country code (e.g., 'USA', 'CAN').
    signup_date DATE NOT NULL                -- Date the user signed up.
);

-- 2. CONTENT TABLE
CREATE TABLE content (
    content_id SERIAL PRIMARY KEY,           -- PK: Unique ID for each piece of content.
    title VARCHAR(255) NOT NULL,             -- Title of the content.
    author VARCHAR(100) NOT NULL,            -- Author or creator of the content.
    category VARCHAR(50) NOT NULL,           -- e.g., 'Fiction', 'Tech', 'Cooking'.
    type VARCHAR(20) NOT NULL,               -- e.g., 'Book', 'Article', 'Video'.
    CHECK (type IN ('Book', 'Article', 'Video')) -- Data integrity check.
);

-- 3. SUBSCRIPTIONS TABLE
CREATE TABLE subscriptions (
    user_id INT NOT NULL,
    plan VARCHAR(50) NOT NULL,               -- e.g., 'Basic', 'Premium', 'Free Trial'.
    start_date DATE NOT NULL,                -- When the plan started.
    end_date DATE,                           -- When the plan ended (NULL if currently active).
    is_active BOOLEAN NOT NULL,              -- True if the subscription is currently valid.
    
    PRIMARY KEY (user_id, start_date),       -- PK: A user can have multiple subscriptions over time.
    FOREIGN KEY (user_id) REFERENCES users(user_id), -- FK: Links to the users table.
    CHECK (end_date IS NULL OR end_date >= start_date) -- Ensures logical date order.
);

-- 4. ENGAGEMENT TABLE
CREATE TABLE engagement (
    user_id INT NOT NULL,
    content_id INT NOT NULL,
    event_type VARCHAR(50) NOT NULL,         -- e.g., 'Start_Read', 'Completed', 'Bookmark', 'View'.
    event_time TIMESTAMP NOT NULL,           -- Exact time of the interaction.
    duration_in_seconds INT,                 -- How long the user engaged (NULL for non-duration events).
    device_type VARCHAR(20) NOT NULL,        -- e.g., 'Mobile', 'Web', 'Tablet'.
    
    PRIMARY KEY (user_id, content_id, event_time), -- PK: Composite key for a unique event record.
    FOREIGN KEY (user_id) REFERENCES users(user_id),    -- FK: Links to the users table.
    FOREIGN KEY (content_id) REFERENCES content(content_id) -- FK: Links to the content table.
);
```

2.3 Sample Dataset (DML: INSERT Statements)
We will use a small, realistic dataset to start practicing queries.

`users` Data

```
INSERT INTO users (user_id, name, country, signup_date) VALUES
(101, 'Alice Johnson', 'USA', '2024-01-15'),
(102, 'Bob Williams', 'CAN', '2024-01-15'),
(103, 'Charlie Brown', 'USA', '2024-02-01'),
(104, 'Dana Smith', 'GBR', '2024-02-10'),
(105, 'Eva Chen', 'USA', '2024-03-05');
```

`content` Data

```
INSERT INTO content (content_id, title, author, category, type) VALUES
(1, 'SQL Mastery Guide', 'A. Data', 'Tech', 'Book'),
(2, 'The Great Outdoors', 'B. Traveler', 'Travel', 'Article'),
(3, '10 Min Home Workout', 'C. Fitness', 'Health', 'Video'),
(4, 'Backend System Design', 'D. Engineer', 'Tech', 'Book'),
(5, 'Cooking with Spice', 'E. Chef', 'Cooking', 'Video');
```

`subscriptions` Data

```
INSERT INTO subscriptions (user_id, plan, start_date, end_date, is_active) VALUES
(101, 'Premium', '2024-01-15', NULL, TRUE),  -- Alice: Active Premium
(102, 'Basic', '2024-01-15', '2024-03-15', FALSE), -- Bob: Basic expired
(102, 'Premium', '2024-03-16', NULL, TRUE), -- Bob: Active Premium upgrade
(103, 'Free Trial', '2024-02-01', '2024-02-29', FALSE), -- Charlie: Trial expired
(105, 'Basic', '2024-03-05', NULL, TRUE);  -- Eva: Active Basic
```

`engagement` Data

```
INSERT INTO engagement (user_id, content_id, event_type, event_time, duration_in_seconds, device_type) VALUES
-- Alice (101) - USA
(101, 1, 'View', '2024-03-10 09:00:00', 120, 'Web'),
(101, 1, 'Completed', '2024-03-10 09:02:00', NULL, 'Web'),
(101, 4, 'View', '2024-03-11 14:30:00', 300, 'Mobile'),

-- Bob (102) - CAN
(102, 2, 'View', '2024-03-10 10:15:00', 60, 'Mobile'),
(102, 3, 'View', '2024-03-12 18:00:00', 600, 'Web'),
(102, 3, 'Completed', '2024-03-12 18:10:00', NULL, 'Web'),

-- Charlie (103) - USA
(103, 1, 'View', '2024-03-13 11:00:00', 90, 'Web'),
(103, 5, 'View', '2024-03-13 11:10:00', 30, 'Web');
```

